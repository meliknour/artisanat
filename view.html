<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>تفاصيل المنتج</title>
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

    // ✅ Firebase Config
    const firebaseConfig = {
      apiKey: "AIzaSyDq-S2CBiNmccar_neNVg5T95XbwV6t0cY",
      authDomain: "artisanat-161f3.firebaseapp.com",
      projectId: "artisanat-161f3",
      storageBucket: "artisanat-161f3.appspot.com",
      messagingSenderId: "203989144161",
      appId: "1:203989144161:web:88273bf2b917ddc0a65020",
      measurementId: "G-9350J62Z5H"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    // ✅ جلب id من الرابط
    const params = new URLSearchParams(window.location.search);
    const productId = params.get("id");

    const container = document.getElementById("productDetails");

    async function loadProduct() {
      if (!productId) {
        container.innerHTML = "<p>❌ لم يتم تمرير معرف المنتج.</p>";
        return;
      }

      try {
        const docRef = doc(db, "products", productId);
        const docSnap = await getDoc(docRef);

        if (docSnap.exists()) {
          const data = docSnap.data();

          container.innerHTML = `
            <h2>${data.name || "منتج بدون اسم"}</h2>
            <img src="${data.image || ""}" alt="صورة المنتج" style="max-width:300px;border-radius:10px;margin:10px 0;">
            <p><b>النوع:</b> ${data.type || "-"}</p>
            <p><b>السعر:</b> ${data.price || "-"}</p>
            <p><b>مدة الإنجاز:</b> ${data.duration || "-"}</p>
            <p><b>الحجم:</b> ${data.size || "-"}</p>
            <p><b>الوزن:</b> ${data.weight || "-"}</p>
            <p><b>الاستعمال:</b> ${data.usage || "-"}</p>
            <p><b>الألوان:</b> ${data.colors || "-"}</p>
            <p><b>نوع التزيين والرموز:</b> ${data.decoration || "-"}</p>
            <p><b>الإنتاج:</b> ${data.production || "-"}</p>
            <p><b>المصدر:</b> ${data.source || "-"}</p>
            <p><b>عدد المتدخلين:</b> ${data.people || "-"}</p>
            <p><b>المواد الأولية:</b> ${data.materials || "-"}</p>
            <p><b>مراحل الإنجاز:</b> ${data.steps || "-"}</p>
            <p><b>الأدوات المستعملة:</b> ${data.tools || "-"}</p>
            <p><b>التقنيات المستعملة:</b> ${data.techniques || "-"}</p>
            <p><b>التقنيات المبتكرة:</b> ${data.innovation || "-"}</p>
            <p><b>📅 تاريخ الإضافة:</b> ${data.timestamp?.toDate ? data.timestamp.toDate().toLocaleString() : "-"}</p>
            <a href="view.html" class="btn-back">⬅️ رجوع إلى القائمة</a>
          `;
        } else {
          container.innerHTML = "<p>❌ المنتج غير موجود.</p>";
        }
      } catch (error) {
        console.error("خطأ في جلب المنتج:", error);
        container.innerHTML = "<p>⚠️ حدث خطأ أثناء تحميل المنتج.</p>";
      }
    }

    loadProduct();
  </script>
  <style>
    body { font-family: Arial, sans-serif; background:#f4f4f4; padding:20px; }
    .container { background:#fff; padding:20px; border-radius:15px; box-shadow:0 0 10px rgba(0,0,0,.1); max-width:600px; margin:auto; }
    h1, h2 { text-align:center; color:#3a3b57; }
    p { margin:8px 0; }
    b { color:#333; }
    .btn-back { display:inline-block; margin-top:20px; padding:10px 15px; background:#3498db; color:white; text-decoration:none; border-radius:8px; }
  </style>
</head>
<body>
  <div class="container">
    <h1>📝 تفاصيل المنتج</h1>
    <div id="productDetails">⏳ جارٍ تحميل البيانات...</div>
  </div>
</body>
</html>
