<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>بطاقة المنتج</title>
  <style>
    body { font-family: Arial, sans-serif; background:#f4f4f4; margin:20px; }
    .container { max-width:900px; margin:auto; background:#fff; padding:25px; border-radius:10px; box-shadow:0 0 10px rgba(0,0,0,0.1);}
    h1 { text-align:center; color:#0056b3; border-bottom:3px solid #0056b3; padding-bottom:10px; }
    #outputImage { max-width:100%; max-height:250px; border:1px solid #ddd; border-radius:4px; margin-bottom:15px; display:block; margin:auto; }
    table { width:100%; border-collapse:collapse; margin-top:20px; }
    th, td { border:1px solid #ddd; padding:10px; text-align:right; }
    th { background:#e9ecef; width:35%; }
  </style>
</head>
<body>

<div class="container">
  <h1>بطاقة تقنية للمنتوج</h1>
  <img id="outputImage">
  <table id="outputTable"></table>
</div>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js"></script>

<script>
  const firebaseConfig = {
    apiKey: "AIzaSyDq-S2CBiNmccar_neNVg5T95XbwV6t0cY",
    authDomain: "artisanat-161f3.firebaseapp.com",
    projectId: "artisanat-161f3",
    storageBucket: "artisanat-161f3.firebasestorage.app",
    messagingSenderId: "203989144161",
    appId: "1:203989144161:web:88273bf2b917ddc0a65020",
    measurementId: "G-9350J62Z5H"
  };
  const app = firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();

  function getIdFromUrl() {
    const params = new URLSearchParams(window.location.search);
    return params.get("id");
  }

  async function loadProduct() {
    const id = getIdFromUrl();
    if (!id) {
      document.getElementById("outputTable").innerHTML = "<tr><td>❌ لم يتم تحديد المنتج</td></tr>";
      return;
    }

    const doc = await db.collection("products").doc(id).get();
    if (!doc.exists) {
      document.getElementById("outputTable").innerHTML = "<tr><td>❌ المنتج غير موجود</td></tr>";
      return;
    }

    const data = doc.data();
    document.getElementById("outputImage").src = data.productImageUrl;

    let tableHTML = "";
    for (const key in data) {
      if (key !== "productImageUrl" && key !== "createdAt") {
        tableHTML += `<tr><th>${key}</th><td>${data[key]}</td></tr>`;
      }
    }
    document.getElementById("outputTable").innerHTML = tableHTML;
  }

  loadProduct();
</script>
</body>
</html>
